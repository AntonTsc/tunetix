<div
  class="min-h-screen bg-gradient-to-b from-indigo-50 via-purple-50 to-gray-100 relative overflow-hidden"
>
  <!-- Elementos decorativos -->
  <div
    class="absolute -left-20 top-10 w-40 h-40 bg-purple-300 bg-opacity-20 rounded-full blur-xl"
  ></div>
  <div
    class="absolute right-10 bottom-10 w-56 h-56 bg-indigo-300 bg-opacity-20 rounded-full blur-xl"
  ></div>

  <!-- Notas musicales flotantes -->
  <div
    class="absolute left-[10%] top-[15%] text-purple-400 text-opacity-30 text-4xl animate-float-slow"
  >
    ♪
  </div>
  <div
    class="absolute right-[15%] top-[25%] text-indigo-400 text-opacity-20 text-5xl animate-float-medium"
  >
    ♫
  </div>
  <div
    class="absolute left-[20%] bottom-[15%] text-pink-400 text-opacity-25 text-3xl animate-float-fast"
  >
    ♩
  </div>
  <div
    class="absolute right-[25%] bottom-[25%] text-blue-400 text-opacity-20 text-4xl animate-float-slow"
    style="animation-delay: 1.2s"
  >
    ♬
  </div>
  <div
    class="absolute left-[40%] top-[35%] text-indigo-400 text-opacity-15 text-3xl animate-float-medium"
    style="animation-delay: 0.8s"
  >
    ♪
  </div>
  <div class="container mx-auto px-4 py-8 relative z-10">
    <!-- Botón de regreso mejorado -->
    <button
      routerLink="/eventos"
      class="flex items-center bg-white px-4 py-2 rounded-lg shadow-md text-purple-600 hover:text-purple-800 mb-6 transition duration-200 hover:shadow-lg back-button-hover"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5 mr-2"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M10 19l-7-7m0 0l7-7m-7 7h18"
        />
      </svg>
      Volver a eventos
    </button>

    <!-- Loader mejorado -->
    <div
      *ngIf="loading"
      class="flex flex-col items-center justify-center py-20"
    >
      <div class="relative">
        <div
          class="w-16 h-16 border-purple-200 border-4 border-dashed rounded-full animate-spin"
        ></div>
        <div
          class="w-16 h-16 border-purple-500 border-t-4 border-b-4 rounded-full animate-spin absolute inset-0"
        ></div>
      </div>
      <p class="text-gray-600 mt-4 font-medium">
        Cargando información del evento...
      </p>
    </div>
    <!-- Error message mejorado -->
    <div
      *ngIf="error"
      class="bg-red-50 border-l-4 border-red-500 p-6 rounded-lg shadow-lg fade-in"
    >
      <div class="flex items-center">
        <div class="bg-red-100 p-3 rounded-full mr-4">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-8 w-8 text-red-500"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </div>
        <div>
          <h3 class="text-lg font-bold text-red-800">
            Oops! Ha ocurrido un error
          </h3>
          <p class="text-red-700 mt-1">{{ error }}</p>
          <button
            routerLink="/eventos"
            class="mt-3 px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-md hover:from-purple-700 hover:to-indigo-700 transition shadow-md hover:shadow-lg"
          >
            Volver a eventos
          </button>
        </div>
      </div>
    </div>
    <!-- Event details -->
    <div *ngIf="event && !loading" class="space-y-8 fade-in">
      <!-- Event header/banner con diseño mejorado -->
      <div class="relative rounded-xl overflow-hidden shadow-xl h-96">
        <div
          class="absolute inset-0 bg-cover bg-center bg-no-repeat parallax-header"
          [style.background-image]="'url(' + getMainImage() + ')'"
        ></div>
        <div
          class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-black/30"
        ></div>
        <div class="absolute bottom-0 p-8 text-white">
          <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-bold mb-3 drop-shadow-lg">
              {{ event.name }}
            </h1>
            <div class="flex flex-wrap gap-3 mb-3">
              <span
                *ngIf="event.dates?.status?.code === 'onsale'"
                class="px-4 py-1.5 text-sm bg-gradient-to-r from-green-500 to-green-600 rounded-full font-medium shadow-md flex items-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 mr-1"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                    clip-rule="evenodd"
                  />
                </svg>
                En venta
              </span>
              <span
                *ngIf="event.dates?.status?.code === 'offsale'"
                class="px-4 py-1.5 text-sm bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-full font-medium shadow-md flex items-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 mr-1"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z"
                    clip-rule="evenodd"
                  />
                </svg>
                Venta cerrada
              </span>
              <span
                *ngIf="event.dates?.status?.code === 'cancelled'"
                class="px-4 py-1.5 text-sm bg-gradient-to-r from-red-500 to-red-600 rounded-full font-medium shadow-md flex items-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 mr-1"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                >
                  <path
                    fill-rule="evenodd"
                    d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                    clip-rule="evenodd"
                  />
                </svg>
                Cancelado
              </span>
              <span
                *ngIf="event._embedded?.attractions"
                class="px-4 py-1.5 text-sm bg-gradient-to-r from-blue-500 to-blue-600 rounded-full font-medium shadow-md flex items-center"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-4 w-4 mr-1"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"
                  />
                </svg>
                {{ event._embedded.attractions[0]?.name }}
              </span>
            </div>
          </div>
        </div>
      </div>
      <!-- Event details grid -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Left column - Event information -->
        <div class="lg:col-span-2 space-y-8">
          <!-- Main info card -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300 fade-in-delay-1"
          >
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 mr-2 text-purple-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
              Detalles del evento
            </h2>

            <div class="space-y-4">
              <div
                class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200"
              >
                <div class="bg-purple-100 p-3 rounded-full mr-4 shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 text-purple-600"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                    />
                  </svg>
                </div>
                <div>
                  <h3 class="text-lg font-medium text-gray-800">Fecha</h3>
                  <p class="text-gray-600">
                    {{ formatDate(event.dates?.start?.localDate) }}
                  </p>
                </div>
              </div>

              <div
                class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200"
              >
                <div class="bg-purple-100 p-3 rounded-full mr-4 shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 text-purple-600"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                    />
                  </svg>
                </div>
                <div>
                  <h3 class="text-lg font-medium text-gray-800">Hora</h3>
                  <p class="text-gray-600">
                    {{ formatTime(event.dates?.start?.localTime) }}
                  </p>
                </div>
              </div>

              <div
                class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200"
              >
                <div class="bg-purple-100 p-3 rounded-full mr-4 shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 text-purple-600"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                    />
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                    />
                  </svg>
                </div>
                <div>
                  <h3 class="text-lg font-medium text-gray-800">Lugar</h3>
                  <p class="text-gray-600">
                    {{ event._embedded?.venues[0]?.name }}
                  </p>
                  <p class="text-gray-500 text-sm">
                    {{ event._embedded?.venues[0]?.address?.line1 }},
                    {{ event._embedded?.venues[0]?.city?.name }},
                    {{ event._embedded?.venues[0]?.country?.name }}
                  </p>
                </div>
              </div>

              <div
                class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200"
                *ngIf="
                  event.classifications && event.classifications.length > 0
                "
              >
                <div class="bg-purple-100 p-3 rounded-full mr-4 shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 text-purple-600"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
                    />
                  </svg>
                </div>
                <div>
                  <h3 class="text-lg font-medium text-gray-800">Categoría</h3>
                  <p class="text-gray-600">
                    {{ event.classifications[0]?.segment?.name || "Música" }} -
                    {{ event.classifications[0]?.genre?.name || "General" }}
                  </p>
                </div>
              </div>

              <div
                class="flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors duration-200"
                *ngIf="event.promoter"
              >
                <div class="bg-purple-100 p-3 rounded-full mr-4 shadow-sm">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5 text-purple-600"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                    />
                  </svg>
                </div>
                <div>
                  <h3 class="text-lg font-medium text-gray-800">Promotor</h3>
                  <p class="text-gray-600">{{ event.promoter?.name }}</p>
                </div>
              </div>
            </div>
          </div>
          <!-- Artists card con el estilo del componente artista -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300 fade-in-delay-2"
            *ngIf="event._embedded?.attractions"
          >
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 mr-2 text-purple-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                />
              </svg>
              Artistas
            </h2>

            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
              <div
                class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition duration-300 transform hover:scale-[1.02]"
                *ngFor="let artist of event._embedded.attractions"
              >
                <div class="text-center">
                  <div
                    class="rounded-full overflow-hidden h-24 w-24 mx-auto mb-3 shadow-md border-2 border-white"
                  >
                    <img
                      [src]="
                        artist.images && artist.images.length > 0
                          ? artist.images[0].url
                          : 'assets/images/default-artist.jpg'
                      "
                      [alt]="artist.name"
                      class="h-full w-full object-cover transition-transform duration-500 hover:scale-110"
                    />
                  </div>
                  <h3 class="font-semibold text-gray-800 mb-2">
                    {{ artist.name }}
                  </h3>

                  <div
                    class="flex justify-center space-x-3"
                    *ngIf="artist.externalLinks"
                  >
                    <a
                      *ngIf="artist.externalLinks?.spotify"
                      [href]="artist.externalLinks.spotify[0]?.url"
                      target="_blank"
                      class="text-green-500 hover:text-green-600 transition-colors duration-200"
                      title="Spotify"
                    >
                      <i class="fab fa-spotify"></i>
                    </a>
                    <a
                      *ngIf="artist.externalLinks?.youtube"
                      [href]="artist.externalLinks.youtube[0]?.url"
                      target="_blank"
                      class="text-red-500 hover:text-red-600 transition-colors duration-200"
                      title="YouTube"
                    >
                      <i class="fab fa-youtube"></i>
                    </a>
                    <a
                      *ngIf="artist.externalLinks?.instagram"
                      [href]="artist.externalLinks.instagram[0]?.url"
                      target="_blank"
                      class="text-pink-500 hover:text-pink-600 transition-colors duration-200"
                      title="Instagram"
                    >
                      <i class="fab fa-instagram"></i>
                    </a>
                    <a
                      *ngIf="artist.externalLinks?.twitter"
                      [href]="artist.externalLinks.twitter[0]?.url"
                      target="_blank"
                      class="text-blue-400 hover:text-blue-500 transition-colors duration-200"
                      title="Twitter"
                    >
                      <i class="fab fa-twitter"></i>
                    </a>
                    <a
                      *ngIf="artist.externalLinks?.facebook"
                      [href]="artist.externalLinks.facebook[0]?.url"
                      target="_blank"
                      class="text-blue-600 hover:text-blue-700 transition-colors duration-200"
                      title="Facebook"
                    >
                      <i class="fab fa-facebook"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Right column - Venue and tickets -->
        <div class="space-y-8">
          <!-- Venue card con el estilo del componente artista -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300 fade-in-delay-1"
          >
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 mr-2 text-blue-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                />
              </svg>
              Ubicación
            </h2>

            <div
              class="venue-details"
              *ngIf="
                event._embedded?.venues && event._embedded.venues.length > 0
              "
            >
              <h3 class="text-lg font-semibold text-gray-800 mb-2">
                {{ event._embedded.venues[0]?.name }}
              </h3>
              <div class="mb-4">
                <p class="text-gray-600 mb-1">
                  {{ event._embedded.venues[0]?.address?.line1 }}
                </p>
                <p class="text-gray-600">
                  {{ event._embedded.venues[0]?.city?.name }},
                  {{ event._embedded.venues[0]?.country?.name }}
                </p>
              </div>

              <button
                *ngIf="
                  event._embedded.venues[0]?.location?.longitude &&
                  event._embedded.venues[0]?.location?.latitude
                "
                (click)="showMap()"
                class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-md hover:from-blue-700 hover:to-indigo-700 transition shadow-md hover:shadow-lg"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5 mr-2"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"
                  />
                </svg>
                Ver en mapa
              </button>
            </div>
          </div>

          <!-- Buy tickets card con el estilo del componente artista -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition-shadow duration-300 fade-in-delay-2"
          >
            <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 mr-2 text-purple-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"
                />
              </svg>
              Entradas
            </h2>
            <!-- Show warning for cancelled events con el estilo del componente artista -->
            <div
              *ngIf="event.dates?.status?.code === 'cancelled'"
              class="text-center py-4"
            >
              <div class="bg-red-50 p-6 rounded-lg shadow-md">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-12 w-12 text-red-500 mx-auto mb-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                <p class="text-red-800 font-medium text-xl mb-2">
                  Evento Cancelado
                </p>
                <p class="text-red-600">
                  Lo sentimos, este evento ha sido cancelado.
                </p>
              </div>
            </div>

            <!-- Show warning for off-sale events con el estilo del componente artista -->
            <div
              *ngIf="event.dates?.status?.code === 'offsale'"
              class="text-center py-4"
            >
              <div class="bg-yellow-50 p-6 rounded-lg shadow-md">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-12 w-12 text-yellow-500 mx-auto mb-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 9v2m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                  />
                </svg>
                <p class="text-yellow-800 font-medium text-xl mb-2">
                  Venta Cerrada
                </p>
                <p class="text-yellow-700">
                  La venta de entradas para este evento ha finalizado.
                </p>
              </div>
            </div>

            <!-- Sección de entradas con el estilo del componente artista -->
            <div
              class="space-y-6"
              *ngIf="
                event.dates?.status?.code !== 'cancelled' &&
                event.dates?.status?.code !== 'offsale'
              "
            >
              <div class="text-center">
                <div class="bg-gray-50 p-6 rounded-lg">
                  <p class="text-sm text-gray-500">Precio por entrada</p>
                  <p class="text-3xl font-bold text-gray-800 my-2">
                    {{ getPrice() }}
                  </p>
                  <p class="text-sm text-gray-500 mb-4">Entrada general</p>
                  <!-- Quantity selector y total: solo visible si está autenticado -->
                  <ng-container *ngIf="isAuthenticated()">
                    <!-- Quantity selector mejorado -->
                    <div
                      class="flex items-center justify-center space-x-4 mt-4"
                    >
                      <button
                        (click)="decreaseTickets()"
                        [disabled]="ticketQuantity <= 1"
                        class="p-2 rounded-full bg-gray-100 hover:bg-purple-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          class="h-6 w-6 text-gray-600"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M20 12H4"
                          />
                        </svg>
                      </button>

                      <div class="w-16 text-center">
                        <input
                          type="number"
                          [(ngModel)]="ticketQuantity"
                          (change)="validateTicketQuantity()"
                          min="1"
                          [max]="maxTickets"
                          class="w-full text-center border border-gray-300 hover:border-purple-300 focus:border-purple-500 focus:ring focus:ring-purple-200 focus:ring-opacity-50 rounded-md py-2 transition-all duration-200"
                        />
                        <p class="text-xs text-gray-500 mt-1">
                          Máx. {{ maxTickets }}
                        </p>
                      </div>

                      <button
                        (click)="increaseTickets()"
                        [disabled]="ticketQuantity >= maxTickets"
                        class="p-2 rounded-full bg-gray-100 hover:bg-purple-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          class="h-6 w-6 text-gray-600"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                          />
                        </svg>
                      </button>
                    </div>
                    <!-- Total mejorado -->
                    <div
                      class="text-center py-4 border-t border-b mt-4 bg-gray-50 rounded-md"
                    >
                      <p class="text-sm text-gray-600">Total</p>
                      <p class="text-2xl font-bold text-purple-700">
                        {{ calculateTotal() }}
                      </p>
                    </div>
                  </ng-container>

                  <!-- Espacio adicional cuando el usuario no está autenticado -->
                  <div *ngIf="!isAuthenticated()" class="mt-6"></div>

                  <!-- Botón condicional según el estado de la autenticación -->
                  <ng-container *ngIf="isAuthenticated(); else loginButton">
                    <button
                      (click)="buyTickets()"
                      class="w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-md transition duration-200 mt-4 shadow-md hover:shadow-lg transform hover:translate-y-[-2px]"
                    >
                      Comprar {{ ticketQuantity }} entrada{{
                        ticketQuantity !== 1 ? "s" : ""
                      }}
                    </button>
                  </ng-container>

                  <ng-template #loginButton>
                    <button
                      (click)="navigateToLogin()"
                      class="w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition duration-200 mt-4 flex items-center justify-center shadow-md hover:shadow-lg transform hover:translate-y-[-2px]"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-5 w-5 mr-2"
                        viewBox="0 0 20 20"
                        fill="currentColor"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M3 3a1 1 0 011-1h12a1 1 0 011 1v14a1 1 0 01-1 1H4a1 1 0 01-1-1V3zm2 2v10h10V5H5z"
                          clip-rule="evenodd"
                        />
                        <path
                          d="M7 7a1 1 0 011-1h4a1 1 0 110 2H8a1 1 0 01-1-1zm1 3a1 1 0 100 2h4a1 1 0 100-2H8z"
                        />
                      </svg>
                      Iniciar sesión
                    </button>
                    <p class="text-center text-sm text-gray-500 mt-2">
                      Necesitas iniciar sesión para comprar entradas
                    </p>
                  </ng-template>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal del mapa -->
  <app-map-modal
    *ngIf="showMapModal"
    [longitude]="parseFloat(event._embedded.venues[0]?.location?.longitude)"
    [latitude]="parseFloat(event._embedded.venues[0]?.location?.latitude)"
    [title]="event._embedded.venues[0]?.name"
    (close)="closeMap()"
  ></app-map-modal>

  <!-- Modal de pago -->
  <app-payment-modal
    [show]="showPaymentModal"
    [eventInfo]="event"
    [quantity]="ticketQuantity"
    [price]="basePrice"
    [isProcessing]="isProcessingPayment"
    (close)="handlePaymentCancel()"
    (confirm)="handlePaymentConfirm($event)"
  ></app-payment-modal>

  <!-- Notificación de éxito con el estilo del componente artista -->
  <div
    *ngIf="showSuccessNotification"
    class="fixed inset-0 flex items-center justify-center z-[1001]"
  >
    <div
      class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"
      (click)="closeSuccessNotification()"
    ></div>
    <div
      class="bg-white rounded-xl p-8 shadow-2xl max-w-md mx-4 relative z-10 transform transition-all animate-scale-in"
    >
      <button
        (click)="closeSuccessNotification()"
        class="absolute top-3 right-3 text-gray-400 hover:text-gray-500 focus:outline-none transition-colors duration-200"
        aria-label="Cerrar"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          ></path>
        </svg>
      </button>

      <div class="text-center">
        <div
          class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"
        >
          <svg
            class="h-10 w-10 text-green-600"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 13l4 4L19 7"
            ></path>
          </svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">
          {{ successMessage }}
        </h3>
        <p class="text-gray-600 mb-6">
          Tus entradas están ahora disponibles en tu historial de compras.
        </p>
        <div class="flex justify-center">
          <button
            (click)="viewPurchaseHistory()"
            class="px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 flex items-center"
          >
            <span>Ver mis entradas</span>
            <svg
              class="ml-2 h-5 w-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M14 5l7 7m0 0l-7 7m7-7H3"
              ></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
